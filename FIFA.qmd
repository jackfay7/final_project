---
title: "Cleaning"
format: html
---

```{r}
library(tidyverse)

fifa_full <- read_csv("data/male_players_legacy_23.csv")



## fifa_full <- read_csv("data/male_players_23.csv", col_select = c(2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 28, 32, 33, 34, 42, 43, 44, 45, 46, 47))
```



```{r}
library(shiny)

variable_choices <- names(fifa_full)[9:10]

ui <- fluidPage(
  sidebarLayout(
    sidebarPanel(
      selectizeInput("player_choice", label = "Choose player(s)",
                     choices = fifa_full$short_name, selected = "L. Messi",
                     multiple = TRUE),
      selectInput("yvar", label = "Choose a Variable", choices = variable_choices)
      ),
    mainPanel(
      plotOutput(outputId = "fifagraph")
    )
  )
)

server <- function(input, output, session) {
  
  fifa_react <- reactive({
    fifa_full |> filter(short_name %in% input$player_choice) 
  })
  
  output$fifagraph <- renderPlot({
    
    ggplot(data = fifa_react(),
           aes(x = fifa_version, y = .data[[input$yvar]], color = short_name)) +
      geom_point()+
      geom_line() +
      theme_minimal(base_size = 30)
    
  })
  
}

shinyApp(ui, server)

```




